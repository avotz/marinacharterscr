jQuery(document).ready(function(v){var k,u=moment.tz.guess()||booking_form_params.server_timezone;function b(e,o){var t=e.closest("form").find(".wc-bookings-booking-form-button");if(void 0!==o){var i=e.find('[data-value="'+o+'"]');if(void 0!==i.data("value"))e.closest("div").find("input").val(o).change(),e.closest("ul").find("a").removeClass("selected"),i.addClass("selected"),t.removeClass("disabled");else t.addClass("disabled")}else t.addClass("disabled")}function e(e){var o=v(e).closest("form"),t=v(e).closest("div").find("fieldset"),a=v(e).closest("div").find(".block-picker"),s=a.find(".selected"),i=t.find("input.booking_date_year").val(),r=parseInt(i,10),n=t.find("input.booking_date_month").val(),c=parseInt(n,10),l=t.find("input.booking_date_day").val(),d=parseInt(l,10),_=i+"-"+n+"-"+l;if(r&&c&&d){a.closest("div").find("input").val("").change(),a.closest("div").block({message:null,overlayCSS:{background:"#fff",backgroundSize:"16px 16px",opacity:.6}}).show(),k&&k.abort();var f=o.serialize(),m=get_client_server_timezone_offset_hrs(_);m<0?f+="&get_next_day=true":0<m&&(f+="&get_prev_day=true"),k=v.ajax({type:"POST",url:booking_form_params.ajax_url,data:{action:"wc_bookings_get_blocks",form:f},success:function(e){var t,i;a.html(e),i=t=0,v(".block-picker a").each(function(){var e=v(this).width(),o=v(this).height();t<e&&(t=e),i<o&&(i=o)}),v(".block-picker a").width(t),v(".block-picker a").height(i),function(a){if(!booking_form_params.timezone_conversion)return;var s=moment.tz(a,u),r=moment(s);r.add(1,"days"),v(".block-picker .block a").each(function(){var e=v(this).attr("data-value"),o=get_client_server_timezone_offset_hrs(a),t=moment.tz(e,booking_form_params.server_timezone),i=moment.tz(e,booking_form_params.server_timezone);if(i.add(o,"hours"),t.isBefore(s)||r.isBefore(t))v(this).parent().remove();else{i.format(booking_form_params.server_time_format);v(this).attr("title","Store server time: "+t.format("YYYY-MM-DD h:mm A")),v(this).text(i.format(booking_form_params.server_time_format))}});get_client_server_timezone_offset_hrs(a)}(_),a.closest("div").unblock(),b(a,s.data("value"))},dataType:"html"})}}booking_form_params.timezone_conversion&&(v(".wc-bookings-date-picker-timezone").text(u.replace("_"," ")),v('[name="wc_bookings_field_start_date_local_timezone"]').val(u)),v(".block-picker").on("click","a",function(){var e=v(this).data("value");return b(v(this).closest("ul"),e),!1}),v("#wc_bookings_field_resource, #wc_bookings_field_duration").change(function(){e(this)}),v(".wc-bookings-booking-form fieldset").on("date-selected",function(){e(this)})});
